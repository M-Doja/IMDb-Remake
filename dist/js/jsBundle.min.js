!function(){"use strict";function e(e,t,o){e.state("Landing",{url:"/",templateUrl:"views/LandingPage.html"}).state("Home",{url:"/home",templateUrl:"views/home.html"}).state("AddMovie",{url:"/add",templateUrl:"views/AddMovie.html"}).state("Login",{url:"/login",templateUrl:"views/Login_Register.html",controller:"GlobalController",controllerAs:"vm"}).state("EditMovie",{url:"/edit/:id",templateUrl:"views/editMovie.html",controller:"HomeController",controllerAs:"vm"}).state("Comments",{url:"/comments/:id",templateUrl:"views/Comments.html",controller:"HomeController",controllerAs:"vm"}),t.otherwise("/"),o.interceptors.push("AuthInterceptor")}angular.module("app",["ui.router"]).config(e),e.$inject=["$stateProvider","$urlRouterProvider","$httpProvider"]}(),function(){"use strict";function e(e,t){var o=this;o.movie={},o.PostMovie=function(){console.log("checking in"),e.addMovie(o.movie).then(function(){t.go("Home")})}}angular.module("app").controller("AddMovieController",e),e.$inject=["HomeFactory","$state"]}(),function(){"use strict";function e(e,t,o){var n=this;n.commment={},t.id&&o.getMoviesById(t.id).then(function(e){n.movie=e}),n.addComment=function(){o.createComment(n.comment,t.id).then(function(e){n.movie=e})}}angular.module("app").controller("CommentController",e),e.$inject=["$state","$stateParams","HomeFactory"]}(),function(){"use strict";function e(e,t){var o=this;o.isLogin=!0,o.user={},o.status=e.status,o.logout=function(){e.logout(),t.go("Landing")},o.registerUser=function(){e.registerUser(o.user).then(function(){t.go("Home")})},o.loginUser=function(){e.loginUser(o.user).then(function(){t.go("Home"),o.user={}})}}angular.module("app").controller("GlobalController",e),e.$inject=["UserFactory","$state"]}(),function(){"use strict";function e(e){var t=this;t.edittedMovie={},e.showMovies().then(function(e){t.movie=e}),t.deleteMovie=function(o){e.deleteMovie(o._id).then(function(){t.movie.splice(t.movie.indexOf(o),1)})},t.getCopy=function(e){return angular.copy(e)},t.editMovie=function(o){e.EditMovie({IDofMovieToEdit:o,edittedMovie:t.edittedMovie}).then(function(o){console.log("Made it back"),t.edittedMovie=null,e.showMovies().then(function(e){t.movies=e})})}}angular.module("app").controller("HomeController",e),e.$inject=["HomeFactory"]}(),function(){"use strict";function e(e){var t={request:function(t){return e.localStorage.getItem("token")&&(t.headers.authorization="Bearer"+e.localStorage.getItem("token")),t}};return t}angular.module("app").factory("AuthInterceptor",e),e.$inject=["$window"]}(),function(){"use strict";function e(e,t){var o={};return o.showMovies=function(){var o=t.defer();return e.get("/api/movies").then(function(e){o.resolve(e.data)}),o.promise},o.getMoviesById=function(o){var n=t.defer();return e.get("/api/movies/"+o).then(function(e){n.resolve(e.data)}),n.promise},o.createComment=function(o,n){console.log(o);var r=t.defer();return e.post("/api/movies/"+n+"/comment",o).then(function(e){r.resolve(e.data)}),r.promise},o.EditMovie=function(o){var n=t.defer();return e.put("/api/movies",o).then(function(e){n.resolve(e.data)}),n.promise},o.deleteMovie=function(o){var n=t.defer();return e["delete"]("/api/movies/"+o).then(function(){n.resolve()}),n.promise},o.addMovie=function(o){var n=t.defer();return console.log("add movie"),e.post("/api/movies",o).then(function(e){n.resolve(e.data)}),n.promise},o}angular.module("app").factory("HomeFactory",e),e.$inject=["$http","$q"]}(),function(){"use strict";function e(e,t){function o(){var e=JSON.parse(s(n().split(".")[1]));a.status.username=e.username,a.status._id=e._id,console.log(a.status)}function n(){return localStorage.getItem("token")}function r(e){return localStorage.setItem("token",e)}function i(){return localStorage.removeItem("token")}function s(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}return decodeURIComponent(escape(window.atob(t)))}var a={};return a.status={},n()&&o(),a.logout=function(){i(),a.status.username=null,a.status._id=null},a.registerUser=function(n){console.log(n);var r=t.defer();return e.post("/api/user/register",n).then(function(e){a.setToken(e.data),o();var t=a.getUser();a.status.username=t.username,a.status._id=t._id,r.resolve(e.data)}),r.promise},a.loginUser=function(n){console.log("Second stop of DF journey");var i=t.defer();return e.post("/api/user/login",n).then(function(e){console.log("Fifth stop"),r(e.data),o();var t=a.getUser();a.status.username=t.username,a.status._id=t._id,i.resolve(e.data)}),i.promise},a.comPost=function(o){var n=t.defer();return e.post("/api/user/comment",o).then(function(e){n.resolve(e.data)}),n.promise},a.getUser=function(){return JSON.parse(s(n().split(".")[1]))},a}angular.module("app").factory("UserFactory",e),e.$inject=["$http","$q"]}();